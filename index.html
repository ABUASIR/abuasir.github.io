<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>تخطي تحديد السرعة</title>

  <!-- ✅ سكربت AdSense (مرة واحدة فقط) -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6596385917043322"
     crossorigin="anonymous"></script>

  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0e0f12;--card:#15171b;--text:#e9edf3;
      --muted:#9aa3b2;--line:#2a2f39;--accent:#22d3ee;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:#0e0f12;
      color:var(--text);
      font-family:"Tajawal",sans-serif;
      display:flex;
      justify-content:center;
      align-items:center;
      flex-direction:column;
      min-height:100vh;
      text-align:center;
      padding:16px;
    }
    .panel{
      background:#15171b;
      border:1px solid var(--line);
      border-radius:14px;
      padding:20px;
      box-shadow:0 0 15px rgba(0,0,0,.5);
      text-align:center;
      width:min(420px,94vw);
      margin-bottom:16px;
    }
    button{
      background:#0f131a;
      border:1px solid var(--line);
      color:var(--text);
      padding:10px 16px;
      border-radius:10px;
      cursor:pointer;
      font-weight:700;
      margin:6px;
      transition:.2s;
      width:100%;
    }
    button:hover{border-color:#3a4454}
    button.active{border-color:var(--accent);color:var(--accent);}
    .count-box{
      display:flex;
      justify-content:center;
      align-items:center;
      gap:8px;
      background:linear-gradient(180deg,rgba(30,34,40,0.9),rgba(16,18,22,0.9));
      border:1px solid var(--line);
      padding:10px 14px;
      border-radius:10px;
      margin:6px auto;
      min-width:160px;
    }
    .count-number{
      font-size:1.6rem;
      font-weight:800;
      width:54px;
      text-align:center;
      color:var(--text);
    }
    .count-label{color:var(--muted);font-size:.95rem;}
    .muted{color:var(--muted);font-size:.95rem;margin-top:8px}
  </style>
</head>
<body>

  <div class="panel">
    <button id="toggleBtn">تشغيل</button>
    <div class="count-box" aria-live="polite">
      <div class="count-label">كل</div>
      <div id="countdown" class="count-number">5</div>
      <div class="count-label">ثوان</div>
    </div>
    <div class="muted">تخطي تحديد السرعة STC</div>
  </div>

  <!-- ✅ إعلان Google AdSense أسفل الصندوق -->
  <ins class="adsbygoogle"
       style="display:block;width:100%;min-height:90px"
       data-ad-format="autorelaxed"
       data-full-width-responsive="true"
       data-ad-client="ca-pub-6596385917043322"
       data-ad-slot="4703512435"></ins>
  <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>

  <script>
    const toggleBtn = document.getElementById("toggleBtn");
    const countdownEl = document.getElementById("countdown");

    // ✅ سيرفرات إثبات المواقع
    const urls = [
      "https://speedtest.saudi.net.sa:8080/speedtest/upload.php",
      "https://jed-speedtest.saudi.net.sa:8080/speedtest/upload.php",
      "https://riyadh-speedtest.saudi.net.sa:8080/speedtest/upload.php",
      "https://dammam-speedtest.saudi.net.sa:8080/speedtest/upload.php",
      "https://baha-speedtest.saudi.net.sa:8080/speedtest/upload.php",
      "https://abha-speedtest.saudi.net.sa:8080/speedtest/upload.php",
      "https://taif-speedtest.saudi.net.sa:8080/speedtest/upload.php",
      "https://makkah-speedtest.saudi.net.sa:8080/speedtest/upload.php",
      "https://bahrah-speedtest.saudi.net.sa:8080/speedtest/upload.php",
      "https://khamismushait-speedtest.saudi.net.sa:8080/speedtest/upload.php"
    ];

    const intervalSec = 5;
    let running = false;
    let worker;
    let tickTimer;

    // ✅ Web Worker لإثبات المواقع
    const workerScript = `
      const urls = ${JSON.stringify(urls)};
      let interval = ${intervalSec} * 1000;
      let timer;
      async function ping(url){
        const controller = new AbortController();
        const t0 = performance.now();
        const to = setTimeout(()=>controller.abort(),10000);
        try{
          await fetch(url,{method:"GET",mode:"no-cors",cache:"no-store",signal:controller.signal});
          postMessage({ok:true,url,ms:Math.round(performance.now()-t0)});
        }catch{
          postMessage({ok:false,url,ms:Math.round(performance.now()-t0)});
        }finally{clearTimeout(to);}
      }
      function checkAll(){ for(const u of urls){ ping(u); } }
      onmessage = e=>{
        if(e.data==="start"){ checkAll(); timer=setInterval(checkAll,interval); }
        else if(e.data==="stop"){ clearInterval(timer); }
      };
    `;

    // ✅ حفظ الحالة بعد التحديث
    function saveState(state){ localStorage.setItem("speedBypassRunning",state?"true":"false"); }

    function start(){
      if(running) return;
      running = true;
      toggleBtn.textContent = "إيقاف";
      toggleBtn.classList.add("active");
      saveState(true);

      const blob = new Blob([workerScript],{type:"application/javascript"});
      worker = new Worker(URL.createObjectURL(blob));
      worker.postMessage("start");
      worker.onmessage = e=>{
        const {ok,url,ms} = e.data;
        console.log(`${ok?"✅":"❌"} ${url} (${ms}ms)`);
      };

      let remaining = intervalSec;
      countdownEl.textContent = remaining;
      if(tickTimer) clearInterval(tickTimer);
      tickTimer = setInterval(()=>{
        remaining = remaining>1?remaining-1:intervalSec;
        countdownEl.textContent = remaining;
      },1000);
    }

    function stop(){
      if(!running) return;
      running = false;
      toggleBtn.textContent = "تشغيل";
      toggleBtn.classList.remove("active");
      saveState(false);
      if(worker){ worker.postMessage("stop"); worker.terminate(); worker=null; }
      if(tickTimer){ clearInterval(tickTimer); tickTimer=null; }
    }

    toggleBtn.addEventListener("click",()=>running?stop():start());
    window.addEventListener("load",()=>{
      if(localStorage.getItem("speedBypassRunning")==="true"){ start(); }
    });
  </script>
</body>
</html>
