<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>حاسبة وتحويل التاريخ تصميم العسيري</title>

<style>
  :root{
    --bg:#050707;
    --card:#0b1a16;
    --card2:#071310;
    --field:#122420;
    --stroke:rgba(0, 207, 232, .22);
    --stroke2:rgba(0, 207, 232, .30);
    --cyan:#00cfe8;
    --green:#0f7a2a;
    --txt:#e7f6f4;
    --muted:#a6c7c2;
  }

  *{box-sizing:border-box}

  body{
    margin:0;
    background:radial-gradient(900px 600px at 50% -10%, rgba(0,207,232,.08), transparent 60%),
               var(--bg);
    color:var(--txt);
    font-family:Tahoma, sans-serif;
    min-height:100vh;
    display:flex;
    flex-direction:column;
  }

  /* ====== Header (التاريخ أعلى الصفحة) ====== */
  header{
    padding:20px 14px 14px;
    text-align:center;
    border-bottom:1px solid rgba(0,207,232,.10);
  }

  .topRow{
    display:flex;
    align-items:center;
    justify-content:center;
    gap:12px;
    font-size:30px;
    font-weight:800;
    color:var(--cyan);
    text-shadow:0 0 18px rgba(0,207,232,.45);
    margin-bottom:10px;
  }

  .cal{
    display:inline-grid;
    place-items:center;
    width:46px;
    height:46px;
    border-radius:10px;
    background:#eef3f6;
    color:#111;
    font-weight:900;
    position:relative;
    overflow:hidden;
    box-shadow:0 0 18px rgba(0,207,232,.25);
  }
  .cal::before{
    content:attr(data-mon);
    position:absolute;
    top:0; left:0; right:0;
    height:16px;
    background:#d61f1f;
    color:#fff;
    font-weight:900;
    font-size:11px;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .cal span{ margin-top:10px; font-size:18px; }

  #todayBoth{
    font-size:22px;
    color:#7fe7f0;
    text-shadow:0 0 10px rgba(0,207,232,.35);
  }

  .dateLTR{
    direction:ltr;
    unicode-bidi:isolate;
    display:inline-block;
  }

  .wrapper{
    width:100%;
    max-width:860px;
    margin:22px auto;
    padding:0 14px 24px;
    display:flex;
    flex-direction:column;
    gap:18px;
    flex:1;
  }

  /* ✅ كرت مضبوط: يمنع خروج العناصر */
  .card{
    width:100%;
    position:relative;
    overflow:hidden;
    border-radius:22px;
    border:1px solid var(--stroke);
    background:linear-gradient(180deg, rgba(11,26,22,.92), rgba(7,19,16,.90));
    box-shadow:0 0 28px rgba(0,207,232,.08);
    padding:18px 16px 18px;
  }

  h2{
    margin:0 0 14px;
    color:var(--cyan);
    font-size:26px;
    font-weight:800;
    text-align:center;
    text-shadow:0 0 14px rgba(0,207,232,.20);
    letter-spacing:.2px;
  }

  /* ✅ شبكة الإدخالات: ثلاث أعمدة داخل الكرت */
  .grid3{
    width:100%;
    max-width:720px;
    margin:0 auto;
    display:grid;
    grid-template-columns:repeat(3, minmax(0, 1fr));
    gap:12px;
  }

  .card input{
    width:100%;
    min-width:0;
    background:rgba(18,36,32,.92);
    border:1px solid var(--stroke);
    border-radius:14px;
    padding:12px 10px;
    color:#fff;
    font-size:18px;
    text-align:center;
    outline:none;
    box-shadow:inset 0 0 0 1px rgba(0,0,0,.25);
  }

  .card input::placeholder{
    color:rgba(166,199,194,.65);
    font-size:14px;
  }

  .btnRow{
    width:100%;
    max-width:720px;
    margin:12px auto 0;
    display:flex;
    flex-direction:column;
    gap:10px;
    align-items:center;
  }

  .btn{
    width:100%;
    max-width:420px;
    border:none;
    border-radius:16px;
    padding:14px 14px;
    font-size:18px;
    font-weight:800;
    cursor:pointer;
    transition:.15s;
  }

  .btn:active{transform:scale(.99)}
  .btnGreen{ background:var(--green); color:#fff; box-shadow:0 0 18px rgba(15,122,42,.35); }
  .btnGreen:hover{filter:brightness(1.06)}

  .btnPeriod{
    background:rgba(0, 207, 232, .07);
    color:var(--cyan);
    border:1px solid var(--stroke2);
  }
  .btnPeriod:hover{background:rgba(0, 207, 232, .10)}

  /* ✅ قائمة الفترة */
  .menu{
    width:100%;
    max-width:420px;
    display:none;
    overflow:hidden;
    border-radius:16px;
    border:1px solid var(--stroke);
    background:rgba(0,0,0,.25);
  }
  .menu.show{display:block}

  .menu button{
    width:100%;
    border:none;
    background:transparent;
    color:var(--txt);
    padding:12px 12px;
    cursor:pointer;
    font-weight:800;
    font-size:16px;
    border-bottom:1px solid rgba(0,207,232,.10);
  }
  .menu button:last-child{border-bottom:none}
  .menu button:hover{background:rgba(0,207,232,.10)}

  /* ✅ نتيجة */
  .result{
    width:100%;
    max-width:720px;
    margin:14px auto 0;
    border-radius:16px;
    border:1px solid rgba(0,207,232,.18);
    background:rgba(0,0,0,.32);
    padding:14px 12px;
    text-align:center;
    font-weight:800;
    font-size:18px;
    display:none;
  }
  .result.show{display:block}

  @media (max-width:640px){
    h2{font-size:22px}
    .card input{font-size:16px}
    .grid3{gap:10px}
    .topRow{font-size:24px}
    #todayBoth{font-size:18px}
  }

  /* ====== Footer (الحقوق) ====== */
  footer{
    padding:14px 10px 18px;
    text-align:center;
    font-size:14px;
    color:#7fdde6;
    opacity:.75;
    text-shadow:0 0 6px rgba(0,207,232,.25);
  }
</style>
</head>

<body>

<!-- ✅ التاريخ أعلى الصفحة -->
<header>
  <div class="topRow">
    <span id="todayLabel">اليوم --</span>
    <span class="cal" id="calBox" data-mon="Jan"><span id="calDay">--</span></span>
  </div>
  <div id="todayBoth">----/--/-- الموافق ----/--/--</div>
</header>

<div class="wrapper">

  <!-- 1) الفترات -->
  <section class="card">
    <h2>إضافة فترات إلى تاريخ ميلادي</h2>

    <div class="grid3">
      <input id="pDay"   type="number" placeholder="اليوم"  min="1" max="31">
      <input id="pMonth" type="number" placeholder="الشهر"  min="1" max="12">
      <input id="pYear"  type="number" placeholder="السنة"  min="1">
    </div>

    <div class="btnRow">
      <button class="btn btnPeriod" id="periodBtn" type="button">فترة</button>

      <div class="menu" id="periodMenu">
        <button type="button" data-days="89">فترة</button>
        <button type="button" data-days="179">فترتين</button>
        <button type="button" data-days="269">ثلاث فترات</button>
      </div>

      <button class="btn btnGreen" id="calcPeriod" type="button">احسب</button>
    </div>

    <div class="result" id="periodRes">—</div>
  </section>

  <!-- 2) هجري -> ميلادي -->
  <section class="card">
    <h2>من هجري إلى ميلادي</h2>

    <div class="grid3">
      <input id="hDay"   type="number" placeholder="اليوم"  min="1" max="30">
      <input id="hMonth" type="number" placeholder="الشهر"  min="1" max="12">
      <input id="hYear"  type="number" placeholder="السنة"  min="1">
    </div>

    <div class="btnRow">
      <button class="btn btnGreen" id="btnH2G" type="button">تحويل</button>
    </div>

    <div class="result" id="h2gRes">—</div>
  </section>

  <!-- 3) ميلادي -> هجري -->
  <section class="card">
    <h2>من ميلادي إلى هجري</h2>

    <div class="grid3">
      <input id="gDay"   type="number" placeholder="اليوم"  min="1" max="31">
      <input id="gMonth" type="number" placeholder="الشهر"  min="1" max="12">
      <input id="gYear"  type="number" placeholder="السنة"  min="1">
    </div>

    <div class="btnRow">
      <button class="btn btnGreen" id="btnG2H" type="button">تحويل</button>
    </div>

    <div class="result" id="g2hRes">—</div>
  </section>

</div>

<!-- ✅ الحقوق أسفل الصفحة -->
<footer>
  © <span id="year"></span> جميع الحقوق محفوظة — تصميم العسيري
</footer>

<script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment-hijri@2.1.2/moment-hijri.js"></script>
<script>
  const $ = (id) => document.getElementById(id);

  const arabicDays = ["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"];
  const pad2 = (n) => String(n).padStart(2, "0");

  const fmtYMD = (m) => `<span class="dateLTR">${m.year()}/${pad2(m.month()+1)}/${pad2(m.date())}</span>`;
  const fmtHijriYMD = (m) => `<span class="dateLTR">${m.format("iYYYY/iMM/iDD")}</span>`;

  // ✅ عرض التاريخ أعلى الصفحة
  function updateHeaderDates(){
    const now = moment();
    const dayName = arabicDays[now.day()];
    $("todayLabel").innerText = `اليوم ${dayName}`;
    $("calBox").setAttribute("data-mon", now.format("MMM"));
    $("calDay").innerText = now.date();
    $("todayBoth").innerHTML = `${fmtHijriYMD(now)} الموافق ${fmtYMD(now)}`;
  }
  updateHeaderDates();

  // سنة الحقوق
  $("year").innerText = new Date().getFullYear();

  // ====== الفترات ======
  let periodDays = 89;

  const periodBtn = $("periodBtn");
  const periodMenu = $("periodMenu");

  periodBtn.addEventListener("click", () => {
    periodMenu.classList.toggle("show");
  });

  periodMenu.querySelectorAll("button").forEach(b => {
    b.addEventListener("click", () => {
      periodDays = Number(b.dataset.days);
      periodBtn.textContent = b.textContent.trim();
      periodMenu.classList.remove("show");
    });
  });

  // إغلاق القائمة بالنقر خارجها
  document.addEventListener("click", (e) => {
    const inside = periodMenu.contains(e.target) || periodBtn.contains(e.target);
    if (!inside) periodMenu.classList.remove("show");
  });

  $("calcPeriod").addEventListener("click", () => {
    const d = Number($("pDay").value);
    const m = Number($("pMonth").value);
    const y = Number($("pYear").value);

    const box = $("periodRes");
    if(!d || !m || !y){
      box.innerHTML = "⚠️ أدخل اليوم ثم الشهر ثم السنة.";
      box.classList.add("show");
      return;
    }

    const start = moment(`${y}/${m}/${d}`, "YYYY/M/D", true);
    if(!start.isValid()){
      box.innerHTML = "⚠️ تاريخ غير صحيح.";
      box.classList.add("show");
      return;
    }

    const end = start.clone().add(periodDays, "days");
    box.innerHTML = `الفترة من ${fmtYMD(start)} إلى ${fmtYMD(end)}`;
    box.classList.add("show");
  });

  // ====== هجري -> ميلادي ======
  $("btnH2G").addEventListener("click", () => {
    const d = Number($("hDay").value);
    const m = Number($("hMonth").value);
    const y = Number($("hYear").value);

    const box = $("h2gRes");
    if(!d || !m || !y){
      box.innerHTML = "⚠️ أدخل اليوم ثم الشهر ثم السنة.";
      box.classList.add("show");
      return;
    }

    const hijri = moment(`${y}/${m}/${d}`, "iYYYY/iM/iD", true);
    if(!hijri.isValid()){
      box.innerHTML = "⚠️ تاريخ هجري غير صحيح.";
      box.classList.add("show");
      return;
    }

    box.innerHTML = `التاريخ الميلادي: ${fmtYMD(hijri)}`;
    box.classList.add("show");
  });

  // ====== ميلادي -> هجري ======
  $("btnG2H").addEventListener("click", () => {
    const d = Number($("gDay").value);
    const m = Number($("gMonth").value);
    const y = Number($("gYear").value);

    const box = $("g2hRes");
    if(!d || !m || !y){
      box.innerHTML = "⚠️ أدخل اليوم ثم الشهر ثم السنة.";
      box.classList.add("show");
      return;
    }

    const g = moment(`${y}/${m}/${d}`, "YYYY/M/D", true);
    if(!g.isValid()){
      box.innerHTML = "⚠️ تاريخ ميلادي غير صحيح.";
      box.classList.add("show");
      box.classList.add("show");
      return;
    }

    box.innerHTML = `التاريخ الهجري: ${fmtHijriYMD(g)}`;
    box.classList.add("show");
  });
</script>
</body>
</html>
